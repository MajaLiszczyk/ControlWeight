<div *ngIf="isLoaded">
    <h1>Measures and history</h1>
    <div>
        <button type="button" class="btn  btn-success" (click)="add()">Add new measure</button>
    </div>
    <a [routerLink]="['/main/menu']">Back to menu</a>
    <div *ngIf="isFormVisible">
        <h2>Wpisz pomiary</h2>
        <form [formGroup]="measureForm">
            <div class="formGroup col-xl-3">
                <label>Date</label>
                <div class="input-group">
                    <input formControlName="measureDate" class="form-control" placeholder="yyyy-mm-dd" aria-label="measure Date"
                    ngbDatepicker #measureDatePicker="ngbDatepicker"
                    [minDate]="{year: 2024, month: 1, day: 1}" [maxDate]="{year: 2200, month: 12, day: 31}"> 
                    <div>
                        <button class="btn btn-outline-secondary pi pi-calendar" (click)="measureDatePicker.toggle()" type="button"></button>
                    </div>
                </div>
                
            </div>
            <div class="formGroup col-xl-3">
                <label>Weight</label>
                <input formControlName="weight" type="number" step="0.01" class="form-control" aria-label="weight" 
                [class.is-invalid]="formWeight.invalid && (formWeight.touched || formWeight.dirty)">
                <div class="invalid-feedback">
                    <span *ngIf="formWeight?.errors?.['max']">Maksymalnie mo≈ºna 500</span>
                    <span *ngIf="formWeight?.errors?.['required']">Wymagane</span>
                </div>
            </div>
            <div class="formGroup col-xl-3">
                <label>Waist</label>
                <input formControlName="waist" type="text" class="form-control" aria-label="waist">
            </div>
            <div class="formGroup col-xl-3">
                <label>Hips</label>
                <input formControlName="hips" type="text" class="form-control" aria-label="hips">
            </div>
            <div class="formGroup col-xl-3">
                <label>Thigh</label>
                <input formControlName="thigh" type="text" class="form-control" aria-label="thigh">
            </div>
            <div class="formGroup col-xl-3">
                <label>Arm</label>
                <input formControlName="arm" type="text" class="form-control" aria-label="arm">
            </div>
            <div class="formGroup col-xl-3">
                <label>Chest</label>
                <input formControlName="chest" type="text" class="form-control" aria-label="chest">
            </div>
            <div>
                
                <div>
                    <button *ngIf="editableMode" type="button" class="btn  btn-success float-right" (click)="save()">Save</button>
                    <button *ngIf="!editableMode" type="button" class="btn  btn-success float-right" (click)="insert()">Insert</button>
                    <button type="button" class="btn  btn-success float-right" (click)="cancel()">Cancel</button>
                </div>
            </div>
            


        </form>
        
    </div>
    <div>
        <div *ngIf="!operationResult?.isSuccess" class="text-danger">
            <span class="font-weight-bold">{{operationResult?.userMessage}}</span>
            <ul>
                <li *ngFor="let error of operationResult?.errors">
                    {{error}}
                </li>
            </ul>
        </div>
        <div *ngIf="operationResult?.isSuccess" class="text-success">
            <span class="font-weight-bold">{{operationResult?.userMessage}}</span>
        </div>
    </div>
    <div>
        <table class="table table-striped">
            <thead class="thead-dark">
                <tr>
                    <th>
                        Date
                    </th>
                    <th>
                        Weight
                    </th>
                    <th>
                        Waist
                    </th>
                    <th>
                        Hips
                    </th>
                    <th>
                        Thigh
                    </th>
                    <th>
                        Arm
                    </th>
                    <th>
                        Chest
                    </th>
                    <th>
                       
                    </th>
                </tr>

            </thead>
            <tr *ngFor="let item of measures">
                <td>
                    {{item.measureDate | date:'yyyy-MM-dd'}}
                </td>
                <td>
                    {{item.weight}}
                </td>
                <td>
                    {{item.waist}}
                </td>
                <td>
                    {{item.hips}}
                </td>
                <td>
                    {{item.thigh}}
                </td>
                <td>
                    {{item.arm}}
                </td>
                <td>
                    {{item.chest}}
                </td>
                <td>
                    <button type="button" class="btn  btn-success float-right" (click)="edit(item)">Edit</button>
                    <button type="button" class="btn  btn-success float-right" (click)="delete(item.id)">Delete</button>
                </td>

            </tr>
            <tr *ngIf="measures.length === 0">
                <td colspan="8">No data</td>
            </tr>

        </table>
    </div>
</div>

